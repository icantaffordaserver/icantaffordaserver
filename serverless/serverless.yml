# Welcome to Serverless!
#
# This file is the main config file for your service.
# It's very minimal at this point and uses default values.
# You can always add more config options for more control.
# We've included some commented out config examples here.
# Just uncomment any of them to get that config option.
#
# For full config options, check the docs:
#    docs.serverless.com
#
# Happy Coding!

service: toktumi-functions

# Use the serverless-webpack plugin to transpile ES6
plugins:
  - serverless-webpack

# Enable auto-packing of external modules
custom:
  webpackIncludeModules: true

provider:
  name: aws
  runtime: nodejs6.10
  stage: dev
  region: us-east-1

functions:
  # Defines an HTTP API endpoint that calls the main function in create.js
  # - path: url path is /notes
  # - method: POST request
  # - cors: enabled CORS (Cross-Origin Resource Sharing) for browser cross
  #     domain api call
  # - authorizer: authenticate the api via Cognito User Pool. Update the 'arn'
  #     with your own User Pool ARN
  addUserToConnection:
    handler: scaphold/logic/addToUsersConnectionsConnection/async/addUserToConnection.handler
    description: Async scaphold logic hook to send email to both users after a user has been added to a connection
    events:
      - http:
          path: addUserToConnection
          method: post
          cors: true

#  validateAndCreateInviteToken:
#    handler: scaphold/logic/createInvites/pre/validateInviteAndCreateInviteToken.handler
#    description: Async scaphold logic hook to send email to both users after a user has been added to a connection
#    events:
#      - http:
#          path: validateAndCreateInviteToken
#          method: post
#          cors: true

  sendInviteEmail:
      handler: scaphold/logic/createInvites/async/sendInviteEmail.handler
      description: Async scaphold logic hook to send email to both users after a user has been added to a connection
      events:
        - http:
            path: sendInviteEmail
            method: post
            cors: true
